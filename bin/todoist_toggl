#!/bin/bash

# ~/.cargo/bin/toggl start $(echo "$(./todoist list | fzf)" | ggrep -oP '#\w+' | sed 's/#//')
task=$(/opt/homebrew/Cellar/todoist/0.20.0/bin/todoist list | fzf)

project=$(echo $task | ggrep -oP '#\w+' | sed 's/#//')

description=$(echo $task | ggrep -oP '(?<=#)\S+\s*\K.*')

echo $project

echo $description

toggl stop
toggl start -o $project "$description"

# current_task=$(http --auth "$TOGGL_API_KEY":api_token --json GET https://api.track.toggl.com/api/v9/me/time_entries/current | jq .id)
# current_task=$(http --auth "$TOGGL_API_KEY":api_token --json GET https://api.track.toggl.com/api/v9/me/time_entries/current)

# if [ $current_task = "null" ]; then
# 	echo "no task is running"
# else
# 	echo "stopping task $current_task"
# fi
#

# ~/.cargo/bin/toggl stop
# ~/.cargo/bin/toggl start -p $project "$description"
